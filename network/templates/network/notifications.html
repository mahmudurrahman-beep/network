{% extends "network/layout.html" %}
{% load static %}

{% block body %}
<style>
    .notifications-container {
        max-width: var(--max-width);
        margin: 0 auto;
    }
    
    .notification-item {
        background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
        border: 1px solid rgba(8,48,71,0.04);
        border-radius: 16px;
        padding: 18px 20px;
        margin-bottom: 12px;
        transition: all 0.2s ease;
        border-left: 4px solid var(--brand-blue);
    }
    
    .notification-item:hover {
        background: linear-gradient(180deg, rgba(255,255,255,1), rgba(255,255,255,0.98));
        transform: translateY(-2px);
        box-shadow: 0 8px 24px rgba(2,6,23,0.06);
        border-color: rgba(8,48,71,0.08);
    }
    
    .notification-username {
        color: var(--brand-blue) !important;
        font-weight: 900;
        text-decoration: none;
        transition: all 0.2s ease;
    }
    
    .notification-username:hover {
        color: var(--brand-teal) !important;
        text-decoration: underline;
    }
    
    .notification-post-link {
        color: var(--muted-dark) !important;
        font-weight: 800;
        text-decoration: none;
        transition: all 0.2s ease;
    }
    
    .notification-post-link:hover {
        color: var(--brand-blue) !important;
        text-decoration: underline;
    }
    
    .notification-timestamp {
        color: rgba(8,48,71,0.65) !important;
        font-size: 0.85rem;
        font-weight: 600;
    }
    
    .notifications-empty-state {
        background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,255,255,0.96));
        border: 1px solid rgba(8,48,71,0.04);
        border-radius: 20px;
        padding: 80px 20px;
        box-shadow: 0 12px 36px rgba(2,6,23,0.04);
    }
    
    .notifications-empty-state h4 {
        color: var(--muted-dark);
        font-weight: 900;
    }
    
    .notifications-empty-state p {
        color: rgba(8,48,71,0.78) !important;
        font-family: Inter, system-ui, -apple-system, sans-serif;
        line-height: 1.6;
    }
</style>

<div class="container mt-5 notifications-container">
    {% if messages %}
      {% for message in messages %}
        <div class="alert alert-{{ message.tags }} alert-dismissible fade show mb-4" role="alert">
          {{ message }}
          <button type="button" class="close" data-dismiss="alert" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
        </div>
      {% endfor %}
    {% endif %}

    <h2 class="mb-4" style="color: var(--muted-dark); font-weight: 900;">Notifications</h2>

    {% if notifications %}
        <div class="list-group">
            {% for notif in notifications %}
                <div class="notification-item list-group-item-action">
                    <div class="d-flex w-100 justify-content-between align-items-start">
                        <div>
                            <h6 class="mb-1" style="color: var(--muted-dark); font-weight: 700;">
                                <!-- Clickable username -->
                                <a href="{% url 'profile' notif.actor.username %}"
                                   class="notification-username">
                                    {{ notif.actor.username }}
                                </a>
                                {{ notif.verb }}
                                {% if notif.post %}
                                    <!-- Clickable post preview -->
                                    on post: 
                                    <a href="{% url 'post_detail' notif.post.id %}"
                                       class="notification-post-link">
                                        "{{ notif.post.content|truncatewords:10 }}"
                                    </a>
                                {% endif %}
                            </h6>
                            {% if notif.timestamp %}
                                <small class="notification-timestamp">
                                    {{ notif.timestamp|timesince }} ago
                                </small>
                            {% endif %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>
    {% else %}
        <div class="text-center notifications-empty-state">
            <h4 class="mb-3">No notifications yet</h4>
            <p>
                When someone follows you, likes your post, or comments,<br>
                you'll see it here.
            </p>
        </div>
    {% endif %}
</div>
{% endblock %}
